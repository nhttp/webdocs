function findBase(i){const t=i.indexOf("/",1);return t!==-1?i.substring(0,t):i}class Router{route={};c_routes=[];midds=[];pmidds={};get;post;put;patch;delete;any;head;options;trace;connect;constructor(){this.get=this.on.bind(this,"GET"),this.post=this.on.bind(this,"POST"),this.put=this.on.bind(this,"PUT"),this.patch=this.on.bind(this,"PATCH"),this.delete=this.on.bind(this,"DELETE"),this.any=this.on.bind(this,"ANY"),this.head=this.on.bind(this,"HEAD"),this.options=this.on.bind(this,"OPTIONS"),this.trace=this.on.bind(this,"TRACE"),this.connect=this.on.bind(this,"CONNECT")}#t=(t,e,r,n,a)=>{if(a!==void 0){const o=findBase(n||"/");a[o]&&(r=a[o].concat(r))}return t.length&&(r=t.concat(r)),r=r.concat([e])};on(t,e,...r){return this.c_routes.push({method:t,path:e,handlers:r}),this}findRoute(t,e,r){let n=[];const a={};if(this.route[t+e]){const x=this.route[t+e];return x.m?n=x.handlers:(n=this.#t(this.midds,r,x.handlers),this.route[t+e]={m:!0,handlers:n}),{params:a,handlers:n}}if(e!=="/"&&e[e.length-1]==="/"){const x=e.slice(0,-1);if(this.route[t+x]){const E=this.route[t+x];return E.m?n=E.handlers:(n=this.#t(this.midds,r,E.handlers),this.route[t+x]={m:!0,handlers:n}),{params:a,handlers:n}}}let o=0,l=0,p={},d=this.route[t]||[],f=[],y=!0;this.route.ANY&&(d=d.concat(this.route.ANY));const w=d.length;for(;o<w;){if(p=d[o],p.pathx&&p.pathx.test(e)){if(y=!1,p.params){for(f=p.pathx.exec(e);l<p.params.length;)a[p.params[l]]=f[++l]||null;a.wild&&(a.wild=a.wild.split("/"))}break}o++}return n=this.#t(this.midds,r,y?[]:p.handlers||[],e,this.pmidds),{params:a,handlers:n}}}const SERIALIZE_COOKIE_REGEXP=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,encoder=new TextEncoder,decoder=new TextDecoder;function findFns(i){let t=[],e=0;const r=i.length;for(;e<r;e++)Array.isArray(i[e])?t=t.concat(findFns(i[e])):typeof i[e]=="function"&&t.push(i[e]);return t}function toBytes(i){const t={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)};if(typeof i=="number")return i;const e=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i.exec(i);let r,n="b";return e?(r=parseFloat(e[1]),n=e[4].toLowerCase()):(r=parseInt(r,10),n="b"),Math.floor(t[n]*r)}function toPathx(i,t){if(i instanceof RegExp)return{params:null,pathx:i};const e=/\?|\*|\./;if(!e.test(i)&&t===!1&&(i.match(/\/:/gi)||[]).length===0)return;let r=[],n="";const a="/([^/]+?)",o="(?:/([^/]+?))?";if(e.test(i)){const d=i.split("/");let f,y,w=0;for(d[0]||d.shift();w<d.length;w++)if(f=d[w],y=f[0],y==="*")r.push("wild"),n+="/(.*)";else if(y===":"){const x=f.indexOf("?")!==-1,E=f.indexOf(".")!==-1;if(x&&!E?n+=o:n+=a,E){const A=f.substring(f.indexOf("."));let L=n+(x?"?":"")+"\\"+A;L=L.replaceAll(a+"\\"+A,"/([\\w-]+"+A+")"),n=L}}else n+="/"+f}else n=i.replace(/\/:[a-z_-]+/gi,a);const l=new RegExp(`^${n}/?$`,"i"),p=i.match(/\:([a-z_-]+)/gi);return r.length?r=(p?p.map(f=>f.substring(1)):[]).concat(r):r=p&&p.map(d=>d.substring(1)),{params:r,pathx:l}}function needPatch(i,t,e){if(t.length===0)return e;let r=t.shift();r||(i=i||[],Array.isArray(i)&&(r=i.length));const n=+r;isNaN(n)||(i=i||[],r=n),i=i||{};const a=needPatch(i[r],t,e);return i[r]=a,i}function myParse(i){return i.reduce((e,[r,n])=>{if(e.hasOwnProperty(r))Array.isArray(e[r])?e[r]=[...e[r],n]:e[r]=[e[r],n];else{let[a,o,l]=r.match(/^([^\[]+)((?:\[[^\]]*\])*)/);l&&(l=Array.from(l.matchAll(/\[([^\]]*)\]/g),p=>p[1]),n=needPatch(e[o],l,n)),e[o]=n}return e},{})}function parseQuery(i){if(i===null)return{};if(typeof i=="string"){const t=new URLSearchParams("?"+i);return myParse(Array.from(t.entries()))}return myParse(Array.from(i.entries()))}function serializeCookie(i,t,e={}){if(!SERIALIZE_COOKIE_REGEXP.test(i))throw new TypeError("name is invalid");if(t!==""&&!SERIALIZE_COOKIE_REGEXP.test(t))throw new TypeError("value is invalid");e.encode=!!e.encode,e.encode&&(t="E:"+btoa(encoder.encode(t).toString()));let r=`${i}=${t}`;if(i.startsWith("__Secure")&&(e.secure=!0),i.startsWith("__Host")&&(e.path="/",e.secure=!0,delete e.domain),e.secure&&(r+="; Secure"),e.httpOnly&&(r+="; HttpOnly"),typeof e.maxAge=="number"&&Number.isInteger(e.maxAge)&&(r+=`; Max-Age=${e.maxAge}`),e.domain){if(!SERIALIZE_COOKIE_REGEXP.test(e.domain))throw new TypeError("domain is invalid");r+=`; Domain=${e.domain}`}if(e.sameSite&&(r+=`; SameSite=${e.sameSite}`),e.path){if(!SERIALIZE_COOKIE_REGEXP.test(e.path))throw new TypeError("path is invalid");r+=`; Path=${e.path}`}if(e.expires){if(typeof e.expires.toUTCString!="function")throw new TypeError("expires is invalid");r+=`; Expires=${e.expires.toUTCString()}`}return e.other&&(r+=`; ${e.other.join("; ")}`),r}function tryDecode(i){try{i=i.substring(2);const t=atob(i),e=Uint8Array.from(t.split(",")),r=decoder.decode(e)||i;if(r!==i&&(r.startsWith("j:{")||r.startsWith("j:["))){const n=r.substring(2);return JSON.parse(n)}return r}catch(t){return i}}function getReqCookies(i,t,e=0){const r=i.headers.get("Cookie");if(r===null)return{};const n={},a=r.split(";"),o=a.length;for(;e<o;){const[l,...p]=a[e].split("="),d=p.join("=");n[l.trim()]=t&&d.startsWith("E:")?tryDecode(d):d,e++}return n}class NHttpError extends Error{status;constructor(t,e=500,r){super(t);this.message=t,this.status=e,this.name=r||"HttpError"}}class BadRequestError extends NHttpError{constructor(t){super(t,400,"BadRequestError")}}class UnauthorizedError extends NHttpError{constructor(t){super(t,401,"UnauthorizedError")}}class PaymentRequiredError extends NHttpError{constructor(t){super(t,402,"PaymentRequiredError")}}class ForbiddenError extends NHttpError{constructor(t){super(t,403,"ForbiddenError")}}class NotFoundError extends NHttpError{constructor(t){super(t,404,"NotFoundError")}}class MethodNotAllowedError extends NHttpError{constructor(t){super(t,405,"MethodNotAllowedError")}}class NotAcceptableError extends NHttpError{constructor(t){super(t,406,"NotAcceptableError")}}class ProxyAuthRequiredError extends NHttpError{constructor(t){super(t,407,"ProxyAuthRequiredError")}}class RequestTimeoutError extends NHttpError{constructor(t){super(t,408,"RequestTimeoutError")}}class ConflictError extends NHttpError{constructor(t){super(t,409,"ConflictError")}}class GoneError extends NHttpError{constructor(t){super(t,410,"GoneError")}}class LengthRequiredError extends NHttpError{constructor(t){super(t,411,"LengthRequiredError")}}class PreconditionFailedError extends NHttpError{constructor(t){super(t,412,"PreconditionFailedError")}}class RequestEntityTooLargeError extends NHttpError{constructor(t){super(t,413,"RequestEntityTooLargeError")}}class RequestURITooLongError extends NHttpError{constructor(t){super(t,414,"RequestURITooLongError")}}class UnsupportedMediaTypeError extends NHttpError{constructor(t){super(t,415,"UnsupportedMediaTypeError")}}class RequestedRangeNotSatisfiableError extends NHttpError{constructor(t){super(t,416,"RequestedRangeNotSatisfiableError")}}class ExpectationFailedError extends NHttpError{constructor(t){super(t,417,"ExpectationFailedError")}}class TeapotError extends NHttpError{constructor(t){super(t,418,"TeapotError")}}class MisdirectedRequestError extends NHttpError{constructor(t){super(t,421,"MisdirectedRequestError")}}class UnprocessableEntityError extends NHttpError{constructor(t){super(t,422,"UnprocessableEntityError")}}class LockedError extends NHttpError{constructor(t){super(t,423,"LockedError")}}class FailedDependencyError extends NHttpError{constructor(t){super(t,424,"FailedDependencyError")}}class TooEarlyError extends NHttpError{constructor(t){super(t,425,"TooEarlyError")}}class UpgradeRequiredError extends NHttpError{constructor(t){super(t,426,"UpgradeRequiredError")}}class PreconditionRequiredError extends NHttpError{constructor(t){super(t,428,"PreconditionRequiredError")}}class TooManyRequestsError extends NHttpError{constructor(t){super(t,429,"TooManyRequestsError")}}class RequestHeaderFieldsTooLargeError extends NHttpError{constructor(t){super(t,431,"RequestHeaderFieldsTooLargeError")}}class UnavailableForLegalReasonsError extends NHttpError{constructor(t){super(t,451,"UnavailableForLegalReasonsError")}}class InternalServerError extends NHttpError{constructor(t){super(t,500,"InternalServerError")}}class NotImplementedError extends NHttpError{constructor(t){super(t,501,"NotImplementedError")}}class BadGatewayError extends NHttpError{constructor(t){super(t,502,"BadGatewayError")}}class ServiceUnavailableError extends NHttpError{constructor(t){super(t,503,"ServiceUnavailableError")}}class GatewayTimeoutError extends NHttpError{constructor(t){super(t,504,"GatewayTimeoutError")}}class HTTPVersionNotSupportedError extends NHttpError{constructor(t){super(t,505,"HTTPVersionNotSupportedError")}}class VariantAlsoNegotiatesError extends NHttpError{constructor(t){super(t,506,"VariantAlsoNegotiatesError")}}class InsufficientStorageError extends NHttpError{constructor(t){super(t,507,"InsufficientStorageError")}}class LoopDetectedError extends NHttpError{constructor(t){super(t,508,"LoopDetectedError")}}class NotExtendedError extends NHttpError{constructor(t){super(t,510,"NotExtendedError")}}class NetworkAuthenticationRequiredError extends NHttpError{constructor(t){super(t,511,"NetworkAuthenticationRequiredError")}}function getError(i,t){let e=i.status||i.statusCode||i.code||500;typeof e!="number"&&(e=500);let r;if(t){const n=i.stack?i.stack.split(`
`):[""];n.shift(),r=n.filter(a=>a.indexOf("file://")!==-1).map(a=>a.trim())}return{status:e,message:i.message||"Something went wrong",name:i.name||"HttpError",stack:r}}const decoder1=new TextDecoder;class Multipart{createBody=(t,{parse:e}={})=>e?e(Object.fromEntries(Array.from(t.keys()).map(r=>[r,t.getAll(r).length>1?t.getAll(r):t.get(r)]))):parseQuery(t);#t=t=>{for(const e in t)if(Array.isArray(t[e])){const r=t[e];for(let n=0;n<r.length;n++)if(r[n]instanceof File){delete t[e];break}}else t[e]instanceof File&&delete t[e]};#e=(t,e)=>{let r=0;const n=t.length;if(e?.maxCount&&n>e.maxCount)throw new BadRequestError(`${e.name} no more than ${e.maxCount} file`);for(;r<n;){const a=t[r],o=a.name.substring(a.name.lastIndexOf(".")+1);if(e?.accept&&!e.accept.includes(o))throw new BadRequestError(`${e.name} only accept ${e.accept}`);if(e?.maxSize&&a.size>toBytes(e.maxSize))throw new BadRequestError(`${e.name} to large, maxSize = ${e.maxSize}`);r++}};#i=async(t,e)=>{const r=Deno.cwd();let n=0;const a=t.length;for(;n<a;){const o=t[n],l=o.name.substring(o.name.lastIndexOf(".")+1);e?.callback&&e.callback(o);let p=e.dest||"";p.lastIndexOf("/")===-1&&(p+="/"),o.filename=o.filename||Date.now()+o.lastModified.toString()+"_"+o.name.substring(0,16).replace(/\./g,"")+"."+l,o.path=o.path||(p!=="/"?p:"")+o.filename;const d=await o.arrayBuffer();await Deno.writeFile(r+"/"+p+o.filename,new Uint8Array(d)),n++}};upload(t){return async(e,r)=>{if(e.body===void 0&&(e.body={}),e.file===void 0&&(e.file={}),e.request.body&&e.request.headers.get("content-type")?.includes("multipart/form-data")){if(e.request.bodyUsed===!1){const n=await e.request.formData();e.body=await this.createBody(n,{parse:e.__parseQuery})}if(Array.isArray(t)){let n=0,a=0;const o=t.length;for(;n<o;){const l=t[n];if(l.required&&e.body[l.name]===void 0)throw new BadRequestError(`Field ${l.name} is required`);if(e.body[l.name]){e.file[l.name]=e.body[l.name];const p=e.file[l.name],d=Array.isArray(p)?p:[p];this.#e(d,l)}n++}for(;a<o;){const l=t[a];if(e.body[l.name]){e.file[l.name]=e.body[l.name];const p=e.file[l.name],d=Array.isArray(p)?p:[p];await this.#i(d,l),delete e.body[l.name]}a++}this.#t(e.body)}else if(typeof t=="object"){const n=t;if(n.required&&e.body[n.name]===void 0)throw new BadRequestError(`Field ${n.name} is required`);if(e.body[n.name]){e.file[n.name]=e.body[n.name];const a=e.file[n.name],o=Array.isArray(a)?a:[a];this.#e(o,n),await this.#i(o,n),delete e.body[n.name]}this.#t(e.body)}}r()}}}async function verifyBody(i,t){const e=await i.arrayBuffer();if(t&&e.byteLength>toBytes(t))throw new BadRequestError(`Body is too large. max limit ${t}`);return decoder1.decode(e)}const multipart=new Multipart;function acceptContentType(i,t){const e=i.get("content-type");return e===t||e?.startsWith(t)}const withBody=async(i,t,e,r,n)=>{if(i.body={},i.request.body&&i.request.bodyUsed===!1){const a=i.request.headers;if(acceptContentType(a,"application/json")){if(n?.json!==0)try{const o=await verifyBody(i.request,n?.json||"3mb");i.body=JSON.parse(o)}catch(o){return t(o)}}else if(acceptContentType(a,"application/x-www-form-urlencoded")){if(n?.urlencoded!==0)try{const o=await verifyBody(i.request,n?.urlencoded||"3mb");i.body=e(o)}catch(o){return t(o)}}else if(acceptContentType(a,"text/plain")){if(n?.raw!==0)try{const o=await verifyBody(i.request,n?.raw||"3mb");try{i.body=JSON.parse(o)}catch(l){i.body={_raw:o}}}catch(o){return t(o)}}else if(acceptContentType(a,"multipart/form-data")&&n?.multipart!==0){const o=await i.request.formData();i.body=await multipart.createBody(o,{parse:r})}}t()},JSON_TYPE_CHARSET="application/json; charset=utf-8";class JsonResponse extends Response{constructor(t,e={}){e.headers=e.headers||new Headers,e.headers.set("content-type",JSON_TYPE_CHARSET),super(JSON.stringify(t),e)}}function response(i,t,e){i.header=function(r,n){if(e.headers=e.headers||new Headers,typeof r=="string"&&typeof n=="string")return e.headers.set(r,n),this;if(typeof r=="object"){if(r instanceof Headers)e.headers=r;else for(const a in r)e.headers.set(a,r[a]);return this}return typeof r=="string"?e.headers.get(r):e.headers},i.status=function(r){return r?(e.status=r,this):e.status||200},i.type=function(r){return this.header("Content-Type",r),this},i.send=function(r){if(typeof r=="object"){if(r instanceof Uint8Array||r instanceof ReadableStream||r instanceof FormData||r instanceof Blob||typeof r.read=="function")return t(new Response(r,e));r=JSON.stringify(r),e.headers=e.headers||new Headers,e.headers.set("Content-Type",JSON_TYPE_CHARSET)}return t(new Response(r,e))},i.json=function(r){return t(new JsonResponse(r,e))},i.redirect=function(r,n){return this.header("Location",r).status(n||302).send()},i.cookie=function(r,n,a={}){return a.httpOnly=a.httpOnly!==!1,a.path=a.path||"/",a.maxAge&&(a.expires=new Date(Date.now()+a.maxAge),a.maxAge/=1e3),n=typeof n=="object"?"j:"+JSON.stringify(n):String(n),this.header().append("Set-Cookie",serializeCookie(r,n,a)),this},i.clearCookie=function(r,n={}){n.httpOnly=n.httpOnly!==!1,this.header().append("Set-Cookie",serializeCookie(r,"",{...n,expires:new Date(0)}))}}class NHttp extends Router{#t;#e;#i;#r;server;constructor({parseQuery:t,bodyLimit:e,env:r}={}){super();this.#t=t||parseQuery,this.#e=t,this.#i=e,this.#r=r||"development",this.fetchEventHandler=this.fetchEventHandler.bind(this),t&&this.use((n,a)=>{n.__parseQuery=t,a()})}onError(t){this.#s=t}on404(t){this.#n=t}use(...t){const e=t[0],r=t[t.length-1];if(t.length===1&&typeof e=="function")this.midds.push(e);else if(typeof e=="string"&&typeof r=="function")e==="/"||e===""?this.midds=this.midds.concat(findFns(t)):this.pmidds[e]=[(a,o)=>{a.url=a.url.substring(e.length)||"/",a.path=a.path&&a.path.substring(e.length)||"/",o()}].concat(findFns(t));else if(typeof r=="object"&&r.c_routes)this.#a(e,t,r.c_routes);else if(Array.isArray(r)){let a=0;const o=r.length;for(;a<o;){const l=r[a];typeof l=="object"&&l.c_routes?this.#a(e,t,l.c_routes):typeof l=="function"&&this.midds.push(l),a++}}else this.midds=this.midds.concat(findFns(t));return this}on(t,e,...r){const n=findFns(r),a=toPathx(e,t==="ANY");return a!==void 0?(this.route[t]=this.route[t]||[],this.route[t].push({...a,handlers:n})):this.route[t+e]={handlers:n},this}handle(t,e=0){this.#c(t);const r=this.findRoute(t.request.method,t._parsedUrl.pathname,this.#n),n=a=>{if(a)return this.#s(a,t,n);let o;try{o=r.handlers[e++](t,n)}catch(l){return n(l)}o&&typeof o.then=="function"&&o.then(void 0).catch(n)};t.params=r.params,t.path=t._parsedUrl.pathname,t.query=this.#t(t._parsedUrl.query),t.search=t._parsedUrl.search,t.getCookies=a=>getReqCookies(t.request,a),response(t.response={},t.respondWith,t.responseInit={}),withBody(t,n,this.#t,this.#e,this.#i)}fetchEventHandler(){return async t=>{let e;const r=new Promise(o=>e=o),n=t.respondWith(r),a=t;a.respondWith=e,this.handle(a),await n}}async listen(t,e){let r=!1;typeof t=="number"?t={port:t}:typeof t=="object"&&(r=t.certFile!==void 0),this.server=r?Deno.listenTls(t):Deno.listen(t);try{for(e&&e(void 0,{...t,hostname:t.hostname||"localhost",server:this.server});;)try{const n=await this.server.accept();if(n)this.#o(n);else break}catch(n){}}catch(n){e&&e(n,{...t,hostname:t.hostname||"localhost",server:this.server})}}#s=(t,e,r)=>{const n=getError(t,this.#r==="development");return e.response.status(n.status).json(n)};#n=(t,e)=>{const r=getError(new NotFoundError(`Route ${t.request.method}${t.url} not found`));return t.response.status(r.status).json(r)};#a=(t,e,r)=>{let n="",a=0;const o=findFns(e),l=r.length;for(typeof t=="string"&&t.length>1&&t.charAt(0)==="/"&&(n=t);a<l;){const p=r[a];p.handlers=o.concat(p.handlers),this.on(p.method,n+p.path,...p.handlers),a++}};#o=async t=>{try{const e=Deno.serveHttp(t);for await(const r of e){let n;const a=new Promise(p=>n=p),o=r.respondWith(a),l=r;l.respondWith=n,this.handle(l),await o}}catch(e){}};#l=t=>{const e=[];let r=-1;for(;(r=t.indexOf("/",r+1))!=-1&&(e.push(r),e.length!==3););return t.substring(e[2])};#c=t=>{const e=t.url=this.#l(t.request.url),r=t._parsedUrl||{};if(r._raw===e)return;let n=e,a=null,o=null,l=0;const p=e.length;for(;l<p;){if(e.charCodeAt(l)===63){n=e.substring(0,l),a=e.substring(l+1),o=e.substring(l);break}l++}r.path=r._raw=r.href=e,r.pathname=n,r.query=a,r.search=o,t._parsedUrl=r}}var h=Object.create,m=Object.defineProperty,u=Object.getOwnPropertyDescriptor,v=Object.getOwnPropertyNames,j=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,w1=i=>m(i,"__esModule",{value:!0}),s=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports),k=(i,t,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of v(t))!b.call(i,r)&&r!=="default"&&m(i,r,{get:()=>t[r],enumerable:!(e=u(t,r))||e.enumerable});return i},c=i=>k(w1(m(i!=null?h(j(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i),r1=s((i,t)=>{"use strict";function e(){this._types=Object.create(null),this._extensions=Object.create(null);for(let r=0;r<arguments.length;r++)this.define(arguments[r]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}e.prototype.define=function(r,n){for(let a in r){let o=r[a].map(function(l){return l.toLowerCase()});a=a.toLowerCase();for(let l=0;l<o.length;l++){let p=o[l];if(p[0]!=="*"){if(!n&&p in this._types)throw new Error('Attempt to change mapping for "'+p+'" extension from "'+this._types[p]+'" to "'+a+'". Pass `force=true` to allow this, otherwise remove "'+p+'" from the list of extensions for "'+a+'".');this._types[p]=a}}if(n||!this._extensions[a]){let l=o[0];this._extensions[a]=l[0]!=="*"?l:l.substr(1)}}},e.prototype.getType=function(r){r=String(r);let n=r.replace(/^.*[/\\]/,"").toLowerCase(),a=n.replace(/^.*\./,"").toLowerCase(),o=n.length<r.length;return(a.length<n.length-1||!o)&&this._types[a]||null},e.prototype.getExtension=function(r){return r=/^\s*([^;\s]*)/.test(r)&&RegExp.$1,r&&this._extensions[r.toLowerCase()]||null},t.exports=e}),g=s((i,t)=>{t.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma","es"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/mrb-consumer+xml":["*xdf"],"application/mrb-publish+xml":["*xdf"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["*xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-error+xml":["xer"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}}),n1=s((i,t)=>{"use strict";var e=r1();t.exports=new e(g())}),_=c(n1()),export_default=_.default;class DenoStdInternalError extends Error{constructor(t){super(t);this.name="DenoStdInternalError"}}function assert(i,t=""){if(!i)throw new DenoStdInternalError(t)}function copy(i,t,e=0){e=Math.max(0,Math.min(e,t.byteLength));const r=t.byteLength-e;return i.byteLength>r&&(i=i.subarray(0,r)),t.set(i,e),i.byteLength}const MIN_READ=32*1024,MAX_SIZE=2**32-2;class Buffer{#t;#e=0;constructor(t){this.#t=t===void 0?new Uint8Array(0):new Uint8Array(t)}bytes(t={copy:!0}){return t.copy===!1?this.#t.subarray(this.#e):this.#t.slice(this.#e)}empty(){return this.#t.byteLength<=this.#e}get length(){return this.#t.byteLength-this.#e}get capacity(){return this.#t.buffer.byteLength}truncate(t){if(t===0){this.reset();return}if(t<0||t>this.length)throw Error("bytes.Buffer: truncation out of range");this.#r(this.#e+t)}reset(){this.#r(0),this.#e=0}#i(t){const e=this.#t.byteLength;return t<=this.capacity-e?(this.#r(e+t),e):-1}#r(t){assert(t<=this.#t.buffer.byteLength),this.#t=new Uint8Array(this.#t.buffer,0,t)}readSync(t){if(this.empty())return this.reset(),t.byteLength===0?0:null;const e=copy(this.#t.subarray(this.#e),t);return this.#e+=e,e}read(t){const e=this.readSync(t);return Promise.resolve(e)}writeSync(t){const e=this.#s(t.byteLength);return copy(t,this.#t,e)}write(t){const e=this.writeSync(t);return Promise.resolve(e)}#s(t){const e=this.length;e===0&&this.#e!==0&&this.reset();const r=this.#i(t);if(r>=0)return r;const n=this.capacity;if(t<=Math.floor(n/2)-e)copy(this.#t.subarray(this.#e),this.#t);else{if(n+t>MAX_SIZE)throw new Error("The buffer cannot be grown beyond the maximum size.");{const a=new Uint8Array(Math.min(2*n+t,MAX_SIZE));copy(this.#t.subarray(this.#e),a),this.#t=a}}return this.#e=0,this.#r(Math.min(e+t,MAX_SIZE)),e}grow(t){if(t<0)throw Error("Buffer.grow: negative count");const e=this.#s(t);this.#r(e)}async readFrom(t){let e=0;const r=new Uint8Array(MIN_READ);for(;;){const n=this.capacity-this.length<MIN_READ,a=n?r:new Uint8Array(this.#t.buffer,this.length),o=await t.read(a);if(o===null)return e;n?this.writeSync(a.subarray(0,o)):this.#r(this.length+o),e+=o}}readFromSync(t){let e=0;const r=new Uint8Array(MIN_READ);for(;;){const n=this.capacity-this.length<MIN_READ,a=n?r:new Uint8Array(this.#t.buffer,this.length),o=t.readSync(a);if(o===null)return e;n?this.writeSync(a.subarray(0,o)):this.#r(this.length+o),e+=o}}}const ANSI_PATTERN=new RegExp(["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|"),"g");var DiffType;(function(i){i.removed="removed",i.common="common",i.added="added"})(DiffType||(DiffType={}));class AssertionError extends Error{constructor(t){super(t);this.name="AssertionError"}}async function readAll(i){const t=new Buffer;return await t.readFrom(i),t.bytes()}async function writeAll(i,t){let e=0;for(;e<t.length;)e+=await i.write(t.subarray(e))}function writeAllSync(i,t){let e=0;for(;e<t.length;)e+=i.writeSync(t.subarray(e))}const DEFAULT_BUF_SIZE=4096,MIN_BUF_SIZE=16,CR="\r".charCodeAt(0),LF=`
`.charCodeAt(0);class BufferFullError extends Error{partial;name="BufferFullError";constructor(t){super("Buffer full");this.partial=t}}class PartialReadError extends Error{name="PartialReadError";partial;constructor(){super("Encountered UnexpectedEof, data only partially read")}}class BufReader{buf;rd;r=0;w=0;eof=!1;static create(t,e=4096){return t instanceof BufReader?t:new BufReader(t,e)}constructor(t,e=4096){e<16&&(e=MIN_BUF_SIZE),this._reset(new Uint8Array(e),t)}size(){return this.buf.byteLength}buffered(){return this.w-this.r}async _fill(){if(this.r>0&&(this.buf.copyWithin(0,this.r,this.w),this.w-=this.r,this.r=0),this.w>=this.buf.byteLength)throw Error("bufio: tried to fill full buffer");for(let t=100;t>0;t--){const e=await this.rd.read(this.buf.subarray(this.w));if(e===null){this.eof=!0;return}if(assert(e>=0,"negative read"),this.w+=e,e>0)return}throw new Error(`No progress after ${100} read() calls`)}reset(t){this._reset(this.buf,t)}_reset(t,e){this.buf=t,this.rd=e,this.eof=!1}async read(t){let e=t.byteLength;if(t.byteLength===0)return e;if(this.r===this.w){if(t.byteLength>=this.buf.byteLength){const n=await this.rd.read(t);return assert((n??0)>=0,"negative read"),n}if(this.r=0,this.w=0,e=await this.rd.read(this.buf),e===0||e===null)return e;assert(e>=0,"negative read"),this.w+=e}const r=copy(this.buf.subarray(this.r,this.w),t,0);return this.r+=r,r}async readFull(t){let e=0;for(;e<t.length;)try{const r=await this.read(t.subarray(e));if(r===null){if(e===0)return null;throw new PartialReadError}e+=r}catch(r){throw r.partial=t.subarray(0,e),r}return t}async readByte(){for(;this.r===this.w;){if(this.eof)return null;await this._fill()}const t=this.buf[this.r];return this.r++,t}async readString(t){if(t.length!==1)throw new Error("Delimiter should be a single character");const e=await this.readSlice(t.charCodeAt(0));return e===null?null:new TextDecoder().decode(e)}async readLine(){let t;try{t=await this.readSlice(LF)}catch(e){let{partial:r}=e;if(assert(r instanceof Uint8Array,"bufio: caught error from `readSlice()` without `partial` property"),!(e instanceof BufferFullError))throw e;return!this.eof&&r.byteLength>0&&r[r.byteLength-1]===CR&&(assert(this.r>0,"bufio: tried to rewind past start of buffer"),this.r--,r=r.subarray(0,r.byteLength-1)),{line:r,more:!this.eof}}if(t===null)return null;if(t.byteLength===0)return{line:t,more:!1};if(t[t.byteLength-1]==LF){let e=1;t.byteLength>1&&t[t.byteLength-2]===CR&&(e=2),t=t.subarray(0,t.byteLength-e)}return{line:t,more:!1}}async readSlice(t){let e=0,r;for(;;){let n=this.buf.subarray(this.r+e,this.w).indexOf(t);if(n>=0){n+=e,r=this.buf.subarray(this.r,this.r+n+1),this.r+=n+1;break}if(this.eof){if(this.r===this.w)return null;r=this.buf.subarray(this.r,this.w),this.r=this.w;break}if(this.buffered()>=this.buf.byteLength){this.r=this.w;const a=this.buf,o=this.buf.slice(0);throw this.buf=o,new BufferFullError(a)}e=this.w-this.r;try{await this._fill()}catch(a){throw a.partial=r,a}}return r}async peek(t){if(t<0)throw Error("negative count");let e=this.w-this.r;for(;e<t&&e<this.buf.byteLength&&!this.eof;){try{await this._fill()}catch(r){throw r.partial=this.buf.subarray(this.r,this.w),r}e=this.w-this.r}if(e===0&&this.eof)return null;if(e<t&&this.eof)return this.buf.subarray(this.r,this.r+e);if(e<t)throw new BufferFullError(this.buf.subarray(this.r,this.w));return this.buf.subarray(this.r,this.r+t)}}class AbstractBufBase{buf;usedBufferBytes=0;err=null;size(){return this.buf.byteLength}available(){return this.buf.byteLength-this.usedBufferBytes}buffered(){return this.usedBufferBytes}}class BufWriter extends AbstractBufBase{writer;static create(t,e=4096){return t instanceof BufWriter?t:new BufWriter(t,e)}constructor(t,e=4096){super();this.writer=t,e<=0&&(e=DEFAULT_BUF_SIZE),this.buf=new Uint8Array(e)}reset(t){this.err=null,this.usedBufferBytes=0,this.writer=t}async flush(){if(this.err!==null)throw this.err;if(this.usedBufferBytes!==0){try{await writeAll(this.writer,this.buf.subarray(0,this.usedBufferBytes))}catch(t){throw this.err=t,t}this.buf=new Uint8Array(this.buf.length),this.usedBufferBytes=0}}async write(t){if(this.err!==null)throw this.err;if(t.length===0)return 0;let e=0,r=0;for(;t.byteLength>this.available();){if(this.buffered()===0)try{r=await this.writer.write(t)}catch(n){throw this.err=n,n}else r=copy(t,this.buf,this.usedBufferBytes),this.usedBufferBytes+=r,await this.flush();e+=r,t=t.subarray(r)}return r=copy(t,this.buf,this.usedBufferBytes),this.usedBufferBytes+=r,e+=r,e}}class BufWriterSync extends AbstractBufBase{writer;static create(t,e=4096){return t instanceof BufWriterSync?t:new BufWriterSync(t,e)}constructor(t,e=4096){super();this.writer=t,e<=0&&(e=DEFAULT_BUF_SIZE),this.buf=new Uint8Array(e)}reset(t){this.err=null,this.usedBufferBytes=0,this.writer=t}flush(){if(this.err!==null)throw this.err;if(this.usedBufferBytes!==0){try{writeAllSync(this.writer,this.buf.subarray(0,this.usedBufferBytes))}catch(t){throw this.err=t,t}this.buf=new Uint8Array(this.buf.length),this.usedBufferBytes=0}}writeSync(t){if(this.err!==null)throw this.err;if(t.length===0)return 0;let e=0,r=0;for(;t.byteLength>this.available();){if(this.buffered()===0)try{r=this.writer.writeSync(t)}catch(n){throw this.err=n,n}else r=copy(t,this.buf,this.usedBufferBytes),this.usedBufferBytes+=r,this.flush();e+=r,t=t.subarray(r)}return r=copy(t,this.buf,this.usedBufferBytes),this.usedBufferBytes+=r,e+=r,e}}class StringReader extends Buffer{constructor(t){super(new TextEncoder().encode(t).buffer)}}class MultiReader{readers;currentIndex=0;constructor(...t){this.readers=t}async read(t){const e=this.readers[this.currentIndex];if(!e)return null;const r=await e.read(t);return r===null?(this.currentIndex++,0):r}}class LimitedReader{reader;limit;constructor(t,e){this.reader=t,this.limit=e}async read(t){if(this.limit<=0)return null;t.length>this.limit&&(t=t.subarray(0,this.limit));const e=await this.reader.read(t);return e==null?null:(this.limit-=e,e)}}function readerFromStreamReader(i){const t=new Buffer;return{async read(e){if(t.empty()){const r=await i.read();if(r.done)return null;await writeAll(t,r.value)}return t.read(e)}}}const decoder2=new TextDecoder;class StringWriter{base;chunks=[];byteLength=0;cache;constructor(t=""){this.base=t;const e=new TextEncoder().encode(t);this.chunks.push(e),this.byteLength+=e.byteLength}write(t){return Promise.resolve(this.writeSync(t))}writeSync(t){return this.chunks.push(t),this.byteLength+=t.byteLength,this.cache=void 0,t.byteLength}toString(){if(this.cache)return this.cache;const t=new Uint8Array(this.byteLength);let e=0;for(const r of this.chunks)t.set(r,e),e+=r.byteLength;return this.cache=decoder2.decode(t),this.cache}}const fetch_url="https://raw.githubusercontent.com/nhttp/webdocs/master/build",app=new NHttp;app.use(async({request:i,response:t,url:e},r)=>{let n=e.slice((e.lastIndexOf(".")-1>>>0)+2)==="",a=fetch_url+e;n&&(a[a.length-1]!=="/"&&(a+="/"),a+="index.html");try{const o=await fetch(a);if(!o.ok||!o.body)return r();const l=new Headers;if(o.headers.get("ETag"))l.set("ETag",o.headers.get("ETag")||"");else if(o.headers.get("last-modified")){const y=o.headers.get("last-modified")||"",w=btoa(y);l.set("last-modified",y),l.set("ETag",`W/"${w}"`)}if(i.headers.get("if-none-match")===l.get("ETag"))return t.status(304).send();i.headers.get("range")&&l.set("Accept-Ranges","bytes");const p=a.substring(a.lastIndexOf(".")+1);l.set("Content-Type",export_default.getType(p));const d=readerFromStreamReader(o.body.getReader()),f=await readAll(d);l.set("x-powered-by","NHttp Deno"),t.header(l).send(f)}catch(o){r(o)}}),app.on404(async({response:i})=>{const e=await(await fetch(fetch_url+"/404.html")).text();i.status(404).type("text/html").send(e)}),addEventListener("fetch",app.fetchEventHandler());
